<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>团长注册并绑定微信</title>
    <script type="text/javascript" src="./static/js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>

    <link rel="stylesheet" type="text/css" href="./static/css/styles.css">
    <link rel="stylesheet" type="text/css" href="./static/css/weui.css">
</head>

<style>
    #reg-title {
        text-align: center;
        line-height: 80px;
        font-size: 1.2rem;
        font-weight: 700;
        color: #707070;
    }
</style>
<body>


<div id="reg-title">
    欢迎注册
</div>

<div id="reg-main">

    <div class="weui-cell">
        <div class="weui-cell__hd"><label class="weui-label">姓名</label></div>
        <div class="weui-cell__bd">
            <input id="name" class="weui-input" type="text" placeholder="请输入姓名">
        </div>
    </div>

    <div class="weui-cell">
        <div class="weui-cell__hd"><label class="weui-label">手机号</label></div>
        <div class="weui-cell__bd">
            <input id="phonenumber" class="weui-input" type="number" pattern="[0-9]*" placeholder="请输入手机号">
        </div>
    </div>

    <div class="weui-cell weui-cell_select weui-cell_select-after">
        <div class="weui-cell__hd">
            <label for="" class="weui-label">小区</label>
        </div>
        <div class="weui-cell__bd">
            <select class="weui-select" id="place"></select>
        </div>
    </div>
    <br><br>

    <a href="javascript:;" class="weui-btn weui-btn_plain-default" id="submit" style="width: 60%">确定</a>
</div>


<script>
    var Request = {};
    Request = GetRequest();

    function GetRequest() {
        var url = location.search;
        var theRequest = new Object();
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            strs = str.split("&");
            for (var i = 0; i < strs.length; i++) {
                theRequest[strs[i].split("=")[0]] = decodeURI(strs[i].split("=")[1]);
            }
        }
        return theRequest;
    }

    var code = Request['code'];
    $(document).ready(function () {

        $.ajax({
            url: 'http://47.93.220.57/groupbuying/api/GetHE',
            type: 'get',
            success: function (res) {
                var temp_str = '';
                for (var i in res.address) {
                    temp_str = temp_str + `<option value="${res.address[i]}">${res.address[i]}</option>`
                }
                $('#place').append(temp_str);
            }
        });


        $("#submit").click(function () {
            var name = $('#name').val();
            var phone = $('#phone').val();
            $.ajax(
                {
                    url: 'http://47.93.220.57/groupbuying/api/AddRC',
                    type: 'GET',
                    data: {
                        code: code,
                        name: $('#name').val(),
                        phone: $('#phonenumber').val(),
                        address:$('#place').val()
                    },
                    success: function (res) {
                        if (res == '1') {
                            alert('提交成功')
                        }
                        else {
                            alert('提交失败')
                        }
                    }
                }
            )
        })
    })

</script>

</body>
</html>